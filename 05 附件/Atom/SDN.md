软件定义网络

---
---

## [[SDN]] 控制平面

SDN 体系结构的关键特征：
1. 基于流的转发
	- 检查三个层面的报文首部，并进行转发
	- SDN 负责维护流表项
2. 数据平面与控制平面分离
	- 前者由**交换机和流表**组成
	- 后者则是**服务器和管理流表的软件**组成
3. 网络控制功能
	- 在服务器上，集中计算、监视网络设备，并进行编程和控制
4. 可编程的网络
	- 控制平面可对软件进行编程，使用 SDN 控制器提供的 API 来控制数据平面

SDN 提供了层次的分离：
1. **硬件**：数据平面交换机
2. **系统软件**：SDN 控制器
3. **应用程序**：网络控制的应用程序

这种分离造就了丰富的生态

---

### SDN 控制平面：SDN 控制器和 SDN 网络控制应用程序

SDN 控制器的功能，组织为 3 个层次：
1. 通信层：SDN 控制器与受控网络设备之间的通信
	- 称为 *南向 API*
	- 底层设备必须向 控制器 报告 本地观察到的事件
2. 网络范围状态管理层
	- 要求获得有关网络的 主机、链路、交换机、其他SDN控制设备 的 最新状态信息
3. 对于网络控制应用程序层的接口
	- 称为 *北向 API*

尽管 SDN 在逻辑上是集中式的，但实际却常采用分布式系统实现

---

### OpenFlow 协议

OpenFLow 协议 属于 SDN 通信层，运行在 TCP 之上，使用 6653 的默认端口号

从控制器流向受控交换机的 重要报文：
1. 配置：修改参数
2. 修改状态：修改流表项
3. 读状态：收集统计数据和计数器
4. 发送分组：用于发送特定端口的特定报文

从受控交换机流向控制器的重要报文如下：
1. 流删除：通知已删除一个流表项 （ACK）
2. 端口状态：通知状态变化
3. 分组入：将分组发送给 SDN 控制器，进行额外处理

---
### 数据平面和控制平面交互的例子

当 某条链路 发生 故障时，发生下面的过程：
1. **交换机** 使用 OpenFlow 报文，向 **SDN 控制器** 通告故障状态
2. **SDN 控制器** 通告 **链路状态管理器**，更新状态
3. 实现 路由选择算法 的 **网络控制应用程序** 先前已经注册，因此也会得到 状态改变 的通告
4. **路由应用程序** 与 **状态管理器** 相互作用，根据网络环境 计算 新的路由表
5. **应用程序** 向 **流表管理器** 通告 新的最短开销路径，更新流表
6. **流表管理器** 更新后，再使用 OpenFlow 报文，更新 底层的 分组交换机状态